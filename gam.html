<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<meta name="viewport" content="width=device-width, inital-scale=1, user-scalable=no">
		<title>My first Three.js app</title>
		<style>
			body { margin: 0; background-color: black; }
			canvas { width: 100%; height: 100%; display: block}
			div { position: fixed; }
			div#newsletter-thing { z-index: 1; top:50%; left: calc((50% - 150px/2)); width: 300px;}
			input{width:100%;}
		</style>
	</head>
	<body>
		<div id="newsletter-thing">
			<div>
				<input type="email" id="email"/>
			</div>
			<div>
				<input type="submit" id="submit"/>
			</div>
		</div>
		
		<div id="canvashub">
		
		</div>

		<script src="node_modules/three/build/three.js"></script>
		<script>
				//To Do:
				//	Add animated texture

				//START: SETUP
				var scene = new THREE.Scene();
				var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight,
															0.1, 1000 );
				var renderer = new THREE.WebGLRenderer();
				renderer.domElement.id = 'canvas';
				renderer.setSize( window.innerWidth, window.innerHeight );


				document.getElementById('canvashub').appendChild( renderer.domElement );
				var canvas = document.getElementById('canvas');
				canvas.setAttribute('z-index', -1);

				canvas.addEventListener( 'click', function(event) {
					if (!document.webkitIsFullScreen) {
						canvas.webkitRequestFullscreen();
					}else{
						document.webkitExitFullscreen();
					}
				}, false);
				//renderer.domElement.requstFullscreen();

				window.addEventListener( 'resize', onWindowResize, false );

				function onWindowResize() {
					camera.aspect = window.innerWidth / window.innerHeight;
					camera.updateProjectionMatrix();
					renderer.setSize( window.innerWidth, window.innerHeight )
				}
				//END: SETUP

				//WHY IS THE TEXTURE BLURRY
				var texture = new THREE.TextureLoader().load("textures/test.png");
				// texture.magFilter = THREE.NearestFilter;
				// texture.minFilter = THREE.LinearMipMapLinearFilter;
				var material = new THREE.MeshBasicMaterial( { map: texture } );
				
				// var plane = new THREE.Mesh( new THREE.PlaneGeometry( 1, 1, 1),
				// 							material );

				// scene.add( plane );
				// plane.rotation.x = Math.PI / 360 * -120;

				var ball = new THREE.Mesh( new THREE.SphereGeometry( 9, 3, 3 ),              
											material);
				scene.add( ball );
				ball.position.y = 8.5;

				var spd = .001;
				var rot = 0;
				ball.rotation.y2 = 0;
				ball.rotation.y1 = 0;

				// ball.position.z = -50;
				// var geometry = new THREE.BoxGeometry( 1, 1, 1 );
				// var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
				// var cube = new THREE.Mesh( geometry, material );
				// scene.add( cube );

				camera.position.z = 5;

				window.addEventListener('devicemotion', function(event){
					var l = Math.abs(event.rotationRate.beta) > 0 ? event.rotationRate.beta : 0;
					rot += l
					ball.rotation.y += l/100;
					if(Math.abs(rot) >= 360){
						spd = spd == 0 ? 0.001 : spd * 2;
						rot = 0;
					}
					console.log(rot);
				});

				window.addEventListener('wheel', function(event){
					console.log(event);
					camera.position.z += event.deltaY / 10;
				});

				function render() {
					ball.position.y -= .0003;
					
					ball.position.z -= .001;
					
					// if(rot < 3){
					// 	spd = spd / 1.5;
					// }
					// spd *= 1.001;
					// spd = spd > 400 ? 400 : spd;
					//var y1old = ball.rotation.y1;
					//ball.rotation.y1 *= 1.001;
					//console.log(ball.rotation.y1 - y1old);

					// ball.position.y = 3.3;
					// ball.position.z = -30;
					// ball.rotation.y1 -= 399;
					// ball.rotation.y = ball.rotation.y1 + ball.rotation.y2;

					//TheFutureIs.now();

					requestAnimationFrame( render );
					renderer.render( scene, camera );
				}
				render();
				screen.orientation.lock('portrait');
		</script>
	</body>
</html>